---
title: "PNP SDK"
description: "TypeScript SDK for PNP Exchange protocol integration"
---

# PNP SDK

The PNP SDK is a comprehensive TypeScript library for interacting with the PNP Exchange protocol on Solana. It provides a clean, type-safe interface for creating markets, trading positions, and managing market operations.

## Quick Start

### Installation

```bash
npm install @pnp-sdk
# or
yarn add @pnp-sdk
```

### Basic Usage

   ```typescript
   import { PNPClient } from '@pnp-sdk';
   import { PublicKey } from '@solana/web3.js';
   
// Initialize client
const client = new PNPClient(
  'https://api.mainnet-beta.solana.com',
  'your-private-key-here'
);

// Create a market
const result = await client.market.createMarket({
  question: 'Will Bitcoin reach $100k by 2025?',
  initialLiquidity: 2_000_000n, // 2 USDC
  endTime: BigInt(Math.floor(Date.now() / 1000) + 30 * 24 * 60 * 60)
});

console.log('Market created:', result.market.toBase58());
```

## Core Features

- **Market Creation**: Deploy prediction markets with configurable parameters
- **Trading**: Buy and sell YES/NO outcome tokens
- **Position Management**: Redeem winning positions and claim creator fees
- **Oracle Integration**: Fetch settlement criteria and market data
- **TypeScript Support**: Full type safety and IntelliSense support
- **Solana Integration**: Built on `@solana/web3.js` with SPL Token support

## API Reference

### PNPClient

The main client class for interacting with the PNP protocol.

```typescript
class PNPClient {
  constructor(rpcUrl: string, privateKey?: Uint8Array | string);
  
  // Core modules
  readonly market?: MarketModule;
  readonly trading?: TradingModule;
  readonly redemption?: RedemptionModule;
  
  // Read-only methods
  fetchMarket(market: PublicKey): Promise<MarketData>;
  fetchMarkets(): Promise<MarketsResponse>;
  fetchGlobalConfig(): Promise<GlobalConfigData>;
  
  // Position management
  redeemPosition(market: PublicKey): Promise<{ signature: string }>;
  claimMarketRefund(market: PublicKey): Promise<{ signature: string }>;
  
  // Oracle integration
  fetchSettlementCriteria(market: string | PublicKey): Promise<SettlementCriteria>;
  fetchSettlementData(market: string | PublicKey): Promise<SettlementData>;
}
```

### Market Creation

Create new prediction markets with the market module.

```typescript
// Create a general prediction market
const market = await client.market.createMarket({
  question: 'Will Ethereum reach $10k by end of 2024?',
  initialLiquidity: 5_000_000n, // 5 USDC
  endTime: BigInt(Math.floor(Date.now() / 1000) + 60 * 24 * 60 * 60), // 60 days
  baseMint: new PublicKey('EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v') // USDC
});

// Create a token price prediction market
const tokenMarket = await client.market.createMarket({
  question: 'Will SOL reach $500 by 2025?',
  initialLiquidity: 3_000_000n, // 3 USDC
  endTime: BigInt(Math.floor(Date.now() / 1000) + 90 * 24 * 60 * 60), // 90 days
  marketType: 'token_price',
  tokenAddress: 'So11111111111111111111111111111111111111112' // SOL
});
```

### Trading

Buy and sell outcome tokens using the trading module.

```typescript
// Buy YES tokens
const buyResult = await client.trading.buyOutcome({
  market: new PublicKey('market-address'),
  outcome: 'YES',
  amountUsdc: 10_000_000 // 10 USDC
});

// Sell NO tokens
const sellResult = await client.trading.sellOutcome({
  market: new PublicKey('market-address'),
  outcome: 'NO',
  tokenAmount: 5_000_000 // 5 tokens
});

// Get market information
const marketInfo = await client.trading.getMarketInfo(
  new PublicKey('market-address')
);
console.log('Current prices:', {
  yes: marketInfo.yesPrice,
  no: marketInfo.noPrice
});
```

### Position Management

Manage your positions and claim rewards.

```typescript
// Redeem winning position after market resolution
const redeemResult = await client.redeemPosition(
  new PublicKey('market-address')
);

// Claim creator refund for non-resolvable markets
const refundResult = await client.claimMarketRefund(
  new PublicKey('market-address')
);
```

### Oracle Integration

Fetch settlement data and market criteria.

```typescript
// Get settlement criteria
const criteria = await client.fetchSettlementCriteria('market-address');
console.log('Resolvable:', criteria.resolvable);
console.log('Winning token:', criteria.winning_token_id);

// Get settlement data
const settlementData = await client.fetchSettlementData('market-address');
console.log('Answer:', settlementData.answer);
console.log('Reasoning:', settlementData.reasoning);

// Wait for criteria with retry logic
const criteriaWithRetry = await client.getSettlementCriteria('market-address', {
  retryDelayMs: 2000,
  maxRetryTimeMs: 15 * 60 * 1000 // 15 minutes
});
```

## CLI Usage

The PNP CLI provides command-line access to all SDK functionality.

### Installation

```bash
npm install -g @pnp-sdk
```

### Environment Setup

```bash
# Required: Solana RPC endpoint
export RPC_URL="https://api.mainnet-beta.solana.com"

# Required: Wallet configuration (choose one)
export WALLET_BS58="your_base58_private_key"
# or
export WALLET_FILE="/path/to/wallet.json"
```

### Commands

#### Market Creation

```bash
# Create a market
pnp create market "Will BTC reach $100K by 2025?" --liquidity 2000000 --end 30

# Create with specific end date
pnp create market "Will ETH reach $10K?" --end "2025-12-31T23:59:59Z"
```

#### Trading

```bash
# Buy tokens
pnp trade <market-id> buy YES 20

# Sell tokens
pnp trade <market-id> sell NO 10.5

# Check balances
pnp trade <market-id> balance

# View prices
pnp trade <market-id> prices
```

#### Market Information

```bash
# Get market status
pnp status <market-id>

# List all markets
pnp fetchMarkets

# Get settlement criteria
pnp settlementCriteria <market-id>
```

## Advanced Usage

### Error Handling

```typescript
try {
  const result = await client.redeemPosition(market);
  console.log('Success:', result.signature);
} catch (error) {
  if (error.message?.includes('not yet resolved')) {
    console.log('Market not yet resolved');
  } else if (error.message?.includes('invalid token account')) {
    console.log('Invalid token account');
  } else {
    console.error('Transaction failed:', error.message);
  }
}
```

### Batch Operations

```typescript
// Create multiple markets
const markets = await Promise.all([
  client.market.createMarket({
    question: 'Will BTC reach $100k?',
    initialLiquidity: 2_000_000n,
    endTime: BigInt(Math.floor(Date.now() / 1000) + 30 * 24 * 60 * 60)
  }),
  client.market.createMarket({
    question: 'Will ETH reach $10k?',
    initialLiquidity: 2_000_000n,
    endTime: BigInt(Math.floor(Date.now() / 1000) + 30 * 24 * 60 * 60)
  })
]);
```

### Custom Configuration

```typescript
// Initialize with custom configuration
const client = new PNPClient(
  'https://api.mainnet-beta.solana.com',
  privateKey,
  {
    commitment: 'confirmed',
    timeout: 30000,
    retryAttempts: 3
  }
);
```

## Type Definitions

### Core Types

```typescript
interface MarketData {
  creator: Uint8Array;
  question: string;
  end_time: bigint;
  resolved: boolean;
  winning_token_id: string;
  resolvable: boolean;
  yes_token_mint: Uint8Array;
  no_token_mint: Uint8Array;
  collateral_token: Uint8Array;
}

interface SettlementCriteria {
  resolvable: boolean;
  winning_token_id?: string;
  reasoning?: string;
}

interface SettlementData {
  answer: string;
  reasoning: string;
}

interface MarketsResponse {
  count: number;
  data: Array<{
    publicKey: string;
    account: MarketData;
  }>;
}
```

### Trading Types

```typescript
interface BuyOutcomeParams {
  market: PublicKey;
  outcome: 'YES' | 'NO';
  amountUsdc: number;
}

interface SellOutcomeParams {
  market: PublicKey;
  outcome: 'YES' | 'NO';
  tokenAmount: number;
}

interface TradeResult {
  signature: string;
  tokensReceived?: number;
  usdcReceived?: number;
}
```

## Best Practices

### Security

- Never expose private keys in client-side code
- Use environment variables for sensitive configuration
- Validate all user inputs before making transactions
- Always verify transaction details before signing

### Performance

- Use connection commitment level 'confirmed' for better performance
- Batch transactions when possible
- Cache frequently accessed accounts
- Implement proper error handling and retry logic

### Development

- Use TypeScript for better type safety
- Follow the latest SDK version for bug fixes and features
- Test thoroughly on devnet before mainnet deployment
- Monitor transaction logs for debugging

## Troubleshooting

### Common Issues

**"Market is not yet resolved"**
- Check if the market has reached its end time
- Verify the market is marked as resolvable
- Wait for oracle settlement to complete

**"Invalid token account"**
- Ensure you have the correct outcome tokens in your wallet
- Check if the market has been resolved
- Verify you're trying to redeem the winning outcome

**"Trading module not available"**
- Ensure you provided a valid private key to the client constructor
- Check that your wallet has sufficient USDC balance
- Verify the market is active and accepting trades

### Getting Help

- Check the [GitHub repository](https://github.com/pnp-protocol/pnp-sdk) for issues and discussions
- Review the [API reference](#api-reference) for detailed method documentation
- Join the community Discord for support and updates

## Changelog

### v1.0.0
- Initial release with core market creation and trading functionality
- Full TypeScript support with comprehensive type definitions
- CLI tool for command-line interactions
- Oracle integration for settlement data
- Comprehensive documentation and examples

## License

Apache-2.0